# ===================================================================
# AUTODIALER DIALPLAN FIX
# ===================================================================
# Muammo: Audio to'liq ijro etilmayapti
# Sabab: DTMF tugmasi bosilganda yoki timeout tugaganda audio to'xtatiladi
# Yechim: Playback() ni noanswer opsiyasi bilan ishlatish va timeout ni oshirish
# ===================================================================

[autodialer-dynamic]
; Qo'ng'iroq boshlanishi
exten => s,1,NoOp(=== Autodialer Call Starting ===)
    same => n,Answer()
    same => n,Wait(1)                              ; 1 soniya kutish
    
    ; DTMF timeout ni o'chirish (audio to'liq eshitilishi uchun)
    same => n,Set(TIMEOUT(digit)=0)                ; DTMF kutish timeout = 0
    same => n,Set(TIMEOUT(response)=20)            ; 20 soniya umumiy timeout
    
    ; Audio ni to'liq ijro etish (DTMF ni ignore qiladi)
    same => n,Playback(${AUDIO_FILE},noanswer)     ; noanswer - DTMF ignore
    
    ; Audio tugagandan keyin qo'shimcha kutish
    same => n,Wait(3)                              ; 3 soniya kutish
    
    ; Tugash
    same => n,NoOp(=== Autodialer Call Completed ===)
    same => n,Hangup()

; Xatolik holati
exten => h,1,NoOp(=== Call Ended ===)

; ===================================================================
# MUHIM ESLATMA:
# - Playback(${AUDIO_FILE},noanswer) - DTMF tugmasi bosilsa ham davom etadi
# - TIMEOUT(digit)=0 - DTMF kutmaslik
# - TIMEOUT(response)=20 - maksimal 20 soniya
# - Wait(3) - audio tugagandan keyin 3 soniya kutish
# ===================================================================
